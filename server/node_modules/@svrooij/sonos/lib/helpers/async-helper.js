"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const event_timeout_error_1 = __importDefault(require("./event-timeout-error"));
/**
 * Async helper exposes a function to wait for an event or timeout.
 *
 * @export
 * @hidden
 * @class AsyncHelper
 */
class AsyncHelper {
    /**
     * Awaitable event handler with timeout
     *
     * @static
     * @template TResult
     * @param {EventEmitter} eventEmitter Event emitter that should be subscribed to.
     * @param {string} eventName Name of event to listen for.
     * @param {number} [timeout] Seconds to wait for event
     * @returns {Promise<TResult>}
     * @memberof AsyncHelper
     */
    static async AsyncEvent(eventEmitter, eventName, timeout) {
        return await new Promise((resolve, reject) => {
            let timer;
            if (timeout !== undefined && timeout > 0) {
                timer = setTimeout(() => {
                    reject(new event_timeout_error_1.default(eventName));
                }, timeout * 1000);
            }
            eventEmitter.once(eventName, (data) => {
                if (timer !== undefined)
                    clearTimeout(timer);
                resolve(data);
            });
        });
    }
    /**
     * Awaitable delay
     *
     * @static
     * @param {number} ms Time to wait in milliseconds
     * @returns {Promise<void>}
     * @memberof AsyncHelper
     */
    static async Delay(ms) {
        await new Promise((resolve) => setTimeout(() => resolve(undefined), ms));
    }
}
exports.default = AsyncHelper;
//# sourceMappingURL=async-helper.js.map