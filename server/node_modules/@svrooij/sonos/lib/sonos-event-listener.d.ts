import BaseService from './services/base-service';
/**
 * SonosEventListener is the internal webservice to handle events.
 *
 * @description the SonosEventListener is created automatically by the first service you start using. You should not call this service by yourself!
 * @export
 * @internal
 * @class SonosEventListener
 */
export default class SonosEventListener {
    private static instance;
    static get DefaultInstance(): SonosEventListener;
    private static getHostIp;
    private readonly proxyHost?;
    private listenerHost;
    private port;
    private readonly debug;
    private listeningSince?;
    private listenerStarted?;
    private get isListening();
    private subscriptions;
    private server;
    private constructor();
    /**
     * Change the settings of the event listener.
     * @param {string?} settings.host - The new host
     * @param {number?} settings.port - The new port - cannot be changed when listener already started
     *
     * @remarks Will only change the host for new subscriptions
     * @returns Returns true is settings where changed and false if settings where not changed (already running)
     */
    UpdateSettings(settings: {
        host?: string;
        port?: number;
    }): boolean;
    private requestHandler;
    private handleHealthRequest;
    private handleStatusRequest;
    private static WriteJson;
    private handleSonosRequest;
    /**
     * Get Endpoint generates the url where the sonos speaker should send it's events.
     * @param uuid The UUID of the sonos speaker
     * @param serviceName The name of the service
     * @remarks Even though this is public, it should not be called by external applications.
     */
    GetEndpoint(uuid: string, serviceName: string): string;
    /**
     * Get debug information about the listener.
     */
    GetStatus(): SonosEventListenerStatus;
    /**
     * Get all active subscriptions
     * @remarks Subscriptions are automatically unregistered, but this doesn't always succeed
     */
    GetSubscriptions(): Array<SubscriptionInfo>;
    /**
     * Register subscription lets the events listener forward the events to the correct service.
     * @param sid Sonos subscription id
     * @param service Instance of the service that will receive the events'
     *
     * @remarks Even though this is public, it should not be called by external applications.
     */
    RegisterSubscription(sid: string, service: BaseService<unknown>): void;
    /**
     * Unregister the subscription, this means that the service will no longer receive these events.
     * @param sid The old subscription ID
     * @remarks Even though this is public, it should not be called by external applications.
     */
    UnregisterSubscription(sid: string): void;
    /**
     * Start the event listener, in case you want the status endpoint without an actual event subscription.
     *
     * @remarks The event listener is started automatically, so you probably don't need to start it yourself.
     */
    StartListener(cb?: (() => void) | undefined): void;
    /**
     * Stop the event listener.
     */
    StopListener(): Promise<void>;
}
interface SubscriptionInfo {
    sid: string;
    service: string;
    uuid: string;
    host: string;
}
interface SonosEventListenerStatus {
    host: string;
    port: number;
    isListening: boolean;
    subscriptionUrl: string;
    listeningSince?: Date;
    subscriptionCount: number;
    currentSubscriptions: Array<SubscriptionInfo>;
}
export {};
//# sourceMappingURL=sonos-event-listener.d.ts.map